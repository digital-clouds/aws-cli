name: "AWS S3 Sync GitHub Action"
description: "Sync a local directory to an S3 bucket using the AWS CLI"
author: "digital-clouds"
branding:
  icon: "upload-cloud"
  color: "blue"
inputs:
  aws_s3_bucket:
    description: "The S3 bucket name to sync to"
    required: true
  aws_access_key_id:
    description: "The AWS access key ID"
    required: true
  aws_secret_access_key:
    description: "The AWS secret access key"
    required: true
  aws_region:
    description: "The AWS region"
    required: false
    default: "us-east-1"
  aws_s3_endpoint_url:
    description: "The AWS endpoint URL"
    required: false
    default: ""
  source_dir:
    description: "The local directory to sync"
    required: false
    default: "."
  destination_dir:
    description: "The S3 bucket directory to sync to"
    required: false
    default: ""
  debug:
    description: "Verbose debugging and logging or carry on, but do quit on errors"
    required: false
    default: "false"
  args:
    description: "Arguments to pass for the awscli sync command"
    required: true
runs:
  using: "docker"
  image: "Dockerfile"
  env:
    AWS_S3_BUCKET: ${{ inputs.aws_s3_bucket }}
    AWS_ACCESS_KEY_ID: ${{ inputs.aws_access_key_id }}
    AWS_SECRET_ACCESS_KEY: ${{ inputs.aws_secret_access_key }}
    AWS_REGION: ${{ inputs.aws_region }}
    AWS_S3_ENDPOINT: ${{ inputs.aws_s3_endpoint_url }}
    SOURCE_DIR: ${{ inputs.source_dir }}
    DESTINATION_DIR: ${{ inputs.destination_dir }}
    DEBUG: ${{ inputs.debug }}
  args:
    - ${{ inputs.args }}
